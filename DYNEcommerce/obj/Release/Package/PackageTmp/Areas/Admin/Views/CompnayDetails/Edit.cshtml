@model Domain.CompnayDetailsDomain

@{
    ViewBag.Title = "Edit";
    Layout = "~/Areas/Admin/Views/Shared/_LayoutPage.cshtml";
}


<div class="page-body">

    <!-- Container-fluid starts-->
    <div class="container-fluid">
        <div class="page-header">
            <div class="row">
                <div class="col-lg-6">
                    <div class="page-header-left">
                        <h3>
                            Create CompanyDetails
                            <small>Bigdeal Admin panel</small>
                        </h3>
                    </div>
                </div>
                <div class="col-lg-6">
                    <ol class="breadcrumb pull-right">
                        <li class="breadcrumb-item"><a href="@Url.Action("Dashboard", "Login")"><i data-feather="home"></i></a></li>
                        <li class="breadcrumb-item"> CompanyDetails </li>
                        <li class="breadcrumb-item active">Create  CompanyDetails </li>
                    </ol>
                </div>
            </div>
        </div>
    </div>

    <div class="container-fluid">
        <div class="row">

            <div class="col-sm-12">
                <div class="card tab2-card">
                    <div class="card-header">
                        <h5> Update CompanyDetails</h5>
                    </div>
                    <div class="card-body">

                        <input type="hidden" value="@Model.Id" id="hdnId" />
                        @Html.ValidationSummary(true, "", new { @class = "text-danger" })

                        @Html.HiddenFor(model => model.Id)

                        <div class="form-group row">
                            <div class="col-xl-3 col-md-4">
                                <label for="validationCustom0"><span>*</span>Name</label>
                            </div>

                            <div class="col-xl-8 col-md-7">
                                @Html.EditorFor(model => model.Name, new { htmlAttributes = new { @class = "form-control", @id = "name" } })
                                @Html.ValidationMessageFor(model => model.Name, "", new { @class = "text-danger" })
                            </div>
                        </div>
                        <br />
                        <div class="form-group row">
                            <div class="col-xl-3 col-md-4">
                                <label for="validationCustom0"><span>*</span>Address</label>
                            </div>

                            <div class="col-xl-8 col-md-7">
                                @Html.EditorFor(model => model.Address, new { htmlAttributes = new { @class = "form-control", @id = "Address" } })
                                @Html.ValidationMessageFor(model => model.Address, "", new { @class = "text-danger" })
                            </div>
                        </div>
                        <br />
                        <div class="form-group row">
                            <div class="col-xl-3 col-md-4">
                                <label for="validationCustom0"><span>*</span>PhoneNumber</label>
                            </div>

                            <div class="col-xl-8 col-md-7">
                                @Html.EditorFor(model => model.PhoneNumber, new { htmlAttributes = new { @class = "form-control", @id = "Phoneno" } })
                                @Html.ValidationMessageFor(model => model.PhoneNumber, "", new { @class = "text-danger" })
                            </div>
                        </div>
                        <br />
                        <div class="form-group row">
                            <div class="col-xl-3 col-md-4">
                                <label for="validationCustom0"><span>*</span>PhoneNumber2</label>
                            </div>

                            <div class="col-xl-8 col-md-7">
                                @Html.EditorFor(model => model.PhoneNumber2, new { htmlAttributes = new { @class = "form-control" } })
                                @Html.ValidationMessageFor(model => model.PhoneNumber2, "", new { @class = "text-danger" })
                            </div>
                        </div>
                        <br />
                        <div class="form-group row">
                            <div class="col-xl-3 col-md-4">
                                <label for="validationCustom0"><span>*</span>EmailAddress</label>
                            </div>

                            <div class="col-xl-8 col-md-7">
                                @Html.EditorFor(model => model.EmailAddress, new { htmlAttributes = new { @class = "form-control", @id = "email" } })
                                @Html.ValidationMessageFor(model => model.EmailAddress, "", new { @class = "text-danger" })
                            </div>
                        </div>
                        <br />
                        <div class="form-group row">
                            <div class="col-xl-3 col-md-4">
                                <label for="validationCustom0"><span>*</span>Logo</label>
                            </div>
                            <div class="col-xl-5 col-md-7">
                                <input type="file" name="ImageName" onchange="readURL(this);" id="UploadImg" />
                                <label>@Model.Logo</label>
                                @Html.HiddenFor(x => x.Logo)
                                @Html.ValidationMessageFor(model => model.Logo, "", new { @class = "text-danger" })
                                <img src="../../../LogoUploadfiles/@Model.Logo" height="50" width="50" class="" />

                                <input type="hidden" id="imgName" value="@Model.Logo" />
                            </div>

                        </div>

                        <br />
                        <div class="form-group row">
                            <div class="col-xl-3 col-md-4">
                                <label for="validationCustom0">FacebookLink</label>
                            </div>

                            <div class="col-xl-8 col-md-7">
                                @Html.EditorFor(model => model.FacebookLink, new { htmlAttributes = new { @class = "form-control", @id = "fb" } })
                                @Html.ValidationMessageFor(model => model.FacebookLink, "", new { @class = "text-danger" })
                            </div>
                        </div>
                        <br />
                        <div class="form-group row">
                            <div class="col-xl-3 col-md-4">
                                <label for="validationCustom0">InstagramLink</label>
                            </div>

                            <div class="col-xl-8 col-md-7">
                                @Html.EditorFor(model => model.InstagramLink, new { htmlAttributes = new { @class = "form-control", @id = "ig" } })
                                @Html.ValidationMessageFor(model => model.InstagramLink, "", new { @class = "text-danger" })
                            </div>
                        </div>
                        <br />
                        <div class="form-group row">
                            <div class="col-xl-3 col-md-4">
                                <label for="validationCustom0">FaxNo</label>
                            </div>

                            <div class="col-xl-8 col-md-7">
                                @Html.EditorFor(model => model.FaxNo, new { htmlAttributes = new { @class = "form-control", @id = "faxno" } })
                                @Html.ValidationMessageFor(model => model.FaxNo, "", new { @class = "text-danger" })
                            </div>
                        </div>

                        <div class="pull-right">
                            <a href="@Url.Action("Index", "CompnayDetails")" class="btn btn-success">
                                Back to List
                            </a>
                            <input type="submit" class="btn btn-primary" value="Save" id="btnSubmit" />
                        </div>
                    </div>

                </div>

            </div>
            <div class="alert alert-success" role="alert" style="display:none" id="divSuccess">
                Company Detail Added Successfully..!!
            </div>
            <div class="alert alert-danger" role="alert" style="display:none" id="divError">
                Company Detail Not Added Successfully..!!
            </div>
        </div>
    </div>
</div>

<script src="~/Assets/JS/jquery-3.3.1.min.js"></script>

<script>
    $(document).ready(function () {
        var emailReg = /^([\w-\.]+@@([\w-]+\.)+[\w-]{2,4})?$/;
        var phonenovalidat = /^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/;
        jQuery("#email").blur(function () {
            var emailaddressVal = $("#email").val();
            if (emailaddressVal == '') {
                $("#email").css('border-color', 'red');
                $("#spnError").text("Please enter your email address.").css('color', 'red');
                $("#btnSubmit").prop('disabled', true);

            }
            else if (!emailReg.test(emailaddressVal)) {
                $("#email").css('border-color', 'red');
                $("#spnError").text("Enter a valid email address.").css('color', 'red');
                $("#btnSubmit").prop('disabled', true);
            }
            else {
                $("#email").css('border-color', 'black');
                $("#spnError").empty();
                $("#btnSubmit").prop('disabled', false);
            }
        });

        jQuery("#Phoneno").blur(function () {
            var Phoneno = $("#Phoneno").val();
            if (Phoneno == '') {
                $("#Phoneno").css('border-color', 'red');
                $("#spnPhoneError").text("Please enter your PhoneNo.").css('color', 'red');
                $("#btnSubmit").prop('disabled', true);

            }
            else if (!phonenovalidat.test(Phoneno)) {
                $("#Phoneno").css('border-color', 'red');
                $("#spnPhoneError").text("Enter a valid PhoneNo").css('color', 'red');
                $("#btnSubmit").prop('disabled', true);
            }
            else {
                $("#Phoneno").css('border-color', 'black');
                $("#spnPhoneError").empty();
                $("#btnSubmit").prop('disabled', false);
            }
        });

        $("#UploadImg").change(function () {
            var data = new FormData();
            var files = $("#UploadImg").get(0).files;
            if (files.length > 0) {
                data.append("MyImages", files[0]);
            }

            $.ajax({
                url: "/CompnayDetails/UploadFile",
                type: "POST",
                processData: false,
                contentType: false,
                data: data,
                success: function (response) {
                    $("#imgName").val(response)
                    //code after success
                },
                error: function (er) {
                    alert(er);
                }

            });
        });
    });


    $("#btnSubmit").click(function () {
        var result = validation();
        if (result == true) {
            var CompanyDetails = {};
            CompanyDetails.Id = $("#hdnId").val();
            CompanyDetails.Name = $("#name").val();
            CompanyDetails.Address = $("#Address").val();
            CompanyDetails.PhoneNumber = $("#Phoneno").val();
            CompanyDetails.PhoneNumber2 = $("#Phone2").val();
            CompanyDetails.EmailAddress = $("#email").val();
            CompanyDetails.Logo = $("#imgName").val();
            CompanyDetails.FacebookLink = $("#fb").val();
            CompanyDetails.InstagramLink = $("#ig").val();
            CompanyDetails.FaxNo = $("#faxno").val();
            //Send the JSON array to Controller using AJAX.
            $.ajax({
                type: "POST",
                url: "/CompnayDetails/Edit",
                data: JSON.stringify(CompanyDetails),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (response) {
                   if (response == "Success") {
                          $("#divSuccess").show();
                        $("#divSuccess").fadeTo(2000, 500).slideUp(500, function () {
                            $("#divSuccess").slideUp(500);
                        });
                    }
                    else {
                        $("#divError").show();
                        $("#divError").fadeTo(2000, 500).slideUp(500, function () {
                            $("#divError").slideUp(500);
                        });
                    }
                }
            });
        }
        else {
            alert("Please Fill All The Details");
        }
    });

    function validation() {
        debugger;
        var result = true;
        var emailReg = /^([\w-\.]+@@([\w-]+\.)+[\w-]{2,4})?$/;

        if ($("#name").val() == '' || $("#name").val() == null) {
            $("#name").css('border-color', 'red');
            result = false;
        }
        if ($("#Address").val() == '' || $("#Address").val() == null) {
            $("#Address").css('border-color', 'red');
            result = false;
        } if ($("#Phoneno").val() == '' || $("#Phoneno").val() == null) {
            $("#Phoneno").css('border-color', 'red');
            result = false;
        }
        if ($("#email").val() == '' || $("#email").val() == null) {
            $("#email").css('border-color', 'red');
            result = false;
        }
        return result;

    }
</script>